{"nbformat":4,"nbformat_minor":0,"metadata":{"colab":{"name":"1) mnist_softmax_SGD.ipynb의 사본","provenance":[{"file_id":"1xqbYgrKk59AzMidwh9eG5ICjkAFwZU4w","timestamp":1593426790318},{"file_id":"15ArrVdJELyV-PeuATH5poe2uZoHm6Ih8","timestamp":1591712241593},{"file_id":"1bimNZtout48XzSy7VoWbmdpOHQ-SAkHX","timestamp":1590895653110}],"collapsed_sections":[]},"kernelspec":{"name":"python3","display_name":"Python 3"},"accelerator":"GPU","widgets":{"application/vnd.jupyter.widget-state+json":{"c921043ccce94cb9adb061444dbc16f3":{"model_module":"@jupyter-widgets/controls","model_name":"HBoxModel","state":{"_view_name":"HBoxView","_dom_classes":[],"_model_name":"HBoxModel","_view_module":"@jupyter-widgets/controls","_model_module_version":"1.5.0","_view_count":null,"_view_module_version":"1.5.0","box_style":"","layout":"IPY_MODEL_afa564afc3b248d7bd11c18aaf0ae875","_model_module":"@jupyter-widgets/controls","children":["IPY_MODEL_37cdb831c73f4743a7c4cb4f3c6276e4","IPY_MODEL_606c911715f546449562c410cf03b82b"]}},"afa564afc3b248d7bd11c18aaf0ae875":{"model_module":"@jupyter-widgets/base","model_name":"LayoutModel","state":{"_view_name":"LayoutView","grid_template_rows":null,"right":null,"justify_content":null,"_view_module":"@jupyter-widgets/base","overflow":null,"_model_module_version":"1.2.0","_view_count":null,"flex_flow":null,"width":null,"min_width":null,"border":null,"align_items":null,"bottom":null,"_model_module":"@jupyter-widgets/base","top":null,"grid_column":null,"overflow_y":null,"overflow_x":null,"grid_auto_flow":null,"grid_area":null,"grid_template_columns":null,"flex":null,"_model_name":"LayoutModel","justify_items":null,"grid_row":null,"max_height":null,"align_content":null,"visibility":null,"align_self":null,"height":null,"min_height":null,"padding":null,"grid_auto_rows":null,"grid_gap":null,"max_width":null,"order":null,"_view_module_version":"1.2.0","grid_template_areas":null,"object_position":null,"object_fit":null,"grid_auto_columns":null,"margin":null,"display":null,"left":null}},"37cdb831c73f4743a7c4cb4f3c6276e4":{"model_module":"@jupyter-widgets/controls","model_name":"FloatProgressModel","state":{"_view_name":"ProgressView","style":"IPY_MODEL_2769768b20fd42d0b91bfb3e0a4b6f3b","_dom_classes":[],"description":"","_model_name":"FloatProgressModel","bar_style":"info","max":1,"_view_module":"@jupyter-widgets/controls","_model_module_version":"1.5.0","value":1,"_view_count":null,"_view_module_version":"1.5.0","orientation":"horizontal","min":0,"description_tooltip":null,"_model_module":"@jupyter-widgets/controls","layout":"IPY_MODEL_40cc35632b6a47d2a6af66636e61f75f"}},"606c911715f546449562c410cf03b82b":{"model_module":"@jupyter-widgets/controls","model_name":"HTMLModel","state":{"_view_name":"HTMLView","style":"IPY_MODEL_5fa4157af22245e8ad211b6d00035375","_dom_classes":[],"description":"","_model_name":"HTMLModel","placeholder":"​","_view_module":"@jupyter-widgets/controls","_model_module_version":"1.5.0","value":" 26427392/? [00:20&lt;00:00, 9166804.54it/s]","_view_count":null,"_view_module_version":"1.5.0","description_tooltip":null,"_model_module":"@jupyter-widgets/controls","layout":"IPY_MODEL_8b3bb95244f44f8e9a85574736c9c299"}},"2769768b20fd42d0b91bfb3e0a4b6f3b":{"model_module":"@jupyter-widgets/controls","model_name":"ProgressStyleModel","state":{"_view_name":"StyleView","_model_name":"ProgressStyleModel","description_width":"initial","_view_module":"@jupyter-widgets/base","_model_module_version":"1.5.0","_view_count":null,"_view_module_version":"1.2.0","bar_color":null,"_model_module":"@jupyter-widgets/controls"}},"40cc35632b6a47d2a6af66636e61f75f":{"model_module":"@jupyter-widgets/base","model_name":"LayoutModel","state":{"_view_name":"LayoutView","grid_template_rows":null,"right":null,"justify_content":null,"_view_module":"@jupyter-widgets/base","overflow":null,"_model_module_version":"1.2.0","_view_count":null,"flex_flow":null,"width":null,"min_width":null,"border":null,"align_items":null,"bottom":null,"_model_module":"@jupyter-widgets/base","top":null,"grid_column":null,"overflow_y":null,"overflow_x":null,"grid_auto_flow":null,"grid_area":null,"grid_template_columns":null,"flex":null,"_model_name":"LayoutModel","justify_items":null,"grid_row":null,"max_height":null,"align_content":null,"visibility":null,"align_self":null,"height":null,"min_height":null,"padding":null,"grid_auto_rows":null,"grid_gap":null,"max_width":null,"order":null,"_view_module_version":"1.2.0","grid_template_areas":null,"object_position":null,"object_fit":null,"grid_auto_columns":null,"margin":null,"display":null,"left":null}},"5fa4157af22245e8ad211b6d00035375":{"model_module":"@jupyter-widgets/controls","model_name":"DescriptionStyleModel","state":{"_view_name":"StyleView","_model_name":"DescriptionStyleModel","description_width":"","_view_module":"@jupyter-widgets/base","_model_module_version":"1.5.0","_view_count":null,"_view_module_version":"1.2.0","_model_module":"@jupyter-widgets/controls"}},"8b3bb95244f44f8e9a85574736c9c299":{"model_module":"@jupyter-widgets/base","model_name":"LayoutModel","state":{"_view_name":"LayoutView","grid_template_rows":null,"right":null,"justify_content":null,"_view_module":"@jupyter-widgets/base","overflow":null,"_model_module_version":"1.2.0","_view_count":null,"flex_flow":null,"width":null,"min_width":null,"border":null,"align_items":null,"bottom":null,"_model_module":"@jupyter-widgets/base","top":null,"grid_column":null,"overflow_y":null,"overflow_x":null,"grid_auto_flow":null,"grid_area":null,"grid_template_columns":null,"flex":null,"_model_name":"LayoutModel","justify_items":null,"grid_row":null,"max_height":null,"align_content":null,"visibility":null,"align_self":null,"height":null,"min_height":null,"padding":null,"grid_auto_rows":null,"grid_gap":null,"max_width":null,"order":null,"_view_module_version":"1.2.0","grid_template_areas":null,"object_position":null,"object_fit":null,"grid_auto_columns":null,"margin":null,"display":null,"left":null}},"864f2d78a279441e8650d7606c487d1f":{"model_module":"@jupyter-widgets/controls","model_name":"HBoxModel","state":{"_view_name":"HBoxView","_dom_classes":[],"_model_name":"HBoxModel","_view_module":"@jupyter-widgets/controls","_model_module_version":"1.5.0","_view_count":null,"_view_module_version":"1.5.0","box_style":"","layout":"IPY_MODEL_60ed340119a34f2db0299eef409d5c99","_model_module":"@jupyter-widgets/controls","children":["IPY_MODEL_8d84a252878e4e0c92d2f1fe17a6d990","IPY_MODEL_44e46d4c36134a989904f44047361be0"]}},"60ed340119a34f2db0299eef409d5c99":{"model_module":"@jupyter-widgets/base","model_name":"LayoutModel","state":{"_view_name":"LayoutView","grid_template_rows":null,"right":null,"justify_content":null,"_view_module":"@jupyter-widgets/base","overflow":null,"_model_module_version":"1.2.0","_view_count":null,"flex_flow":null,"width":null,"min_width":null,"border":null,"align_items":null,"bottom":null,"_model_module":"@jupyter-widgets/base","top":null,"grid_column":null,"overflow_y":null,"overflow_x":null,"grid_auto_flow":null,"grid_area":null,"grid_template_columns":null,"flex":null,"_model_name":"LayoutModel","justify_items":null,"grid_row":null,"max_height":null,"align_content":null,"visibility":null,"align_self":null,"height":null,"min_height":null,"padding":null,"grid_auto_rows":null,"grid_gap":null,"max_width":null,"order":null,"_view_module_version":"1.2.0","grid_template_areas":null,"object_position":null,"object_fit":null,"grid_auto_columns":null,"margin":null,"display":null,"left":null}},"8d84a252878e4e0c92d2f1fe17a6d990":{"model_module":"@jupyter-widgets/controls","model_name":"FloatProgressModel","state":{"_view_name":"ProgressView","style":"IPY_MODEL_f78a13ee60f2472cb2bbc87c40c37854","_dom_classes":[],"description":"","_model_name":"FloatProgressModel","bar_style":"success","max":1,"_view_module":"@jupyter-widgets/controls","_model_module_version":"1.5.0","value":1,"_view_count":null,"_view_module_version":"1.5.0","orientation":"horizontal","min":0,"description_tooltip":null,"_model_module":"@jupyter-widgets/controls","layout":"IPY_MODEL_d9fac0bce0d04fa18acc720c54725003"}},"44e46d4c36134a989904f44047361be0":{"model_module":"@jupyter-widgets/controls","model_name":"HTMLModel","state":{"_view_name":"HTMLView","style":"IPY_MODEL_6a234fa9b50445d6a3b3a06bf93c87df","_dom_classes":[],"description":"","_model_name":"HTMLModel","placeholder":"​","_view_module":"@jupyter-widgets/controls","_model_module_version":"1.5.0","value":" 32768/? [00:01&lt;00:00, 17950.27it/s]","_view_count":null,"_view_module_version":"1.5.0","description_tooltip":null,"_model_module":"@jupyter-widgets/controls","layout":"IPY_MODEL_99fe4151fded434ca5edbe663e2f805c"}},"f78a13ee60f2472cb2bbc87c40c37854":{"model_module":"@jupyter-widgets/controls","model_name":"ProgressStyleModel","state":{"_view_name":"StyleView","_model_name":"ProgressStyleModel","description_width":"initial","_view_module":"@jupyter-widgets/base","_model_module_version":"1.5.0","_view_count":null,"_view_module_version":"1.2.0","bar_color":null,"_model_module":"@jupyter-widgets/controls"}},"d9fac0bce0d04fa18acc720c54725003":{"model_module":"@jupyter-widgets/base","model_name":"LayoutModel","state":{"_view_name":"LayoutView","grid_template_rows":null,"right":null,"justify_content":null,"_view_module":"@jupyter-widgets/base","overflow":null,"_model_module_version":"1.2.0","_view_count":null,"flex_flow":null,"width":null,"min_width":null,"border":null,"align_items":null,"bottom":null,"_model_module":"@jupyter-widgets/base","top":null,"grid_column":null,"overflow_y":null,"overflow_x":null,"grid_auto_flow":null,"grid_area":null,"grid_template_columns":null,"flex":null,"_model_name":"LayoutModel","justify_items":null,"grid_row":null,"max_height":null,"align_content":null,"visibility":null,"align_self":null,"height":null,"min_height":null,"padding":null,"grid_auto_rows":null,"grid_gap":null,"max_width":null,"order":null,"_view_module_version":"1.2.0","grid_template_areas":null,"object_position":null,"object_fit":null,"grid_auto_columns":null,"margin":null,"display":null,"left":null}},"6a234fa9b50445d6a3b3a06bf93c87df":{"model_module":"@jupyter-widgets/controls","model_name":"DescriptionStyleModel","state":{"_view_name":"StyleView","_model_name":"DescriptionStyleModel","description_width":"","_view_module":"@jupyter-widgets/base","_model_module_version":"1.5.0","_view_count":null,"_view_module_version":"1.2.0","_model_module":"@jupyter-widgets/controls"}},"99fe4151fded434ca5edbe663e2f805c":{"model_module":"@jupyter-widgets/base","model_name":"LayoutModel","state":{"_view_name":"LayoutView","grid_template_rows":null,"right":null,"justify_content":null,"_view_module":"@jupyter-widgets/base","overflow":null,"_model_module_version":"1.2.0","_view_count":null,"flex_flow":null,"width":null,"min_width":null,"border":null,"align_items":null,"bottom":null,"_model_module":"@jupyter-widgets/base","top":null,"grid_column":null,"overflow_y":null,"overflow_x":null,"grid_auto_flow":null,"grid_area":null,"grid_template_columns":null,"flex":null,"_model_name":"LayoutModel","justify_items":null,"grid_row":null,"max_height":null,"align_content":null,"visibility":null,"align_self":null,"height":null,"min_height":null,"padding":null,"grid_auto_rows":null,"grid_gap":null,"max_width":null,"order":null,"_view_module_version":"1.2.0","grid_template_areas":null,"object_position":null,"object_fit":null,"grid_auto_columns":null,"margin":null,"display":null,"left":null}},"6c49c79ac9dd4afcb123eb425ca400a2":{"model_module":"@jupyter-widgets/controls","model_name":"HBoxModel","state":{"_view_name":"HBoxView","_dom_classes":[],"_model_name":"HBoxModel","_view_module":"@jupyter-widgets/controls","_model_module_version":"1.5.0","_view_count":null,"_view_module_version":"1.5.0","box_style":"","layout":"IPY_MODEL_769c685125ac43fcbb5e088d75df8421","_model_module":"@jupyter-widgets/controls","children":["IPY_MODEL_f88d31ceae9548d4bffea960f31d73f2","IPY_MODEL_41ae02a4ae9d454fab2a632d2a9754af"]}},"769c685125ac43fcbb5e088d75df8421":{"model_module":"@jupyter-widgets/base","model_name":"LayoutModel","state":{"_view_name":"LayoutView","grid_template_rows":null,"right":null,"justify_content":null,"_view_module":"@jupyter-widgets/base","overflow":null,"_model_module_version":"1.2.0","_view_count":null,"flex_flow":null,"width":null,"min_width":null,"border":null,"align_items":null,"bottom":null,"_model_module":"@jupyter-widgets/base","top":null,"grid_column":null,"overflow_y":null,"overflow_x":null,"grid_auto_flow":null,"grid_area":null,"grid_template_columns":null,"flex":null,"_model_name":"LayoutModel","justify_items":null,"grid_row":null,"max_height":null,"align_content":null,"visibility":null,"align_self":null,"height":null,"min_height":null,"padding":null,"grid_auto_rows":null,"grid_gap":null,"max_width":null,"order":null,"_view_module_version":"1.2.0","grid_template_areas":null,"object_position":null,"object_fit":null,"grid_auto_columns":null,"margin":null,"display":null,"left":null}},"f88d31ceae9548d4bffea960f31d73f2":{"model_module":"@jupyter-widgets/controls","model_name":"FloatProgressModel","state":{"_view_name":"ProgressView","style":"IPY_MODEL_84d5052f9bea4336b690475409cbef97","_dom_classes":[],"description":"","_model_name":"FloatProgressModel","bar_style":"success","max":1,"_view_module":"@jupyter-widgets/controls","_model_module_version":"1.5.0","value":1,"_view_count":null,"_view_module_version":"1.5.0","orientation":"horizontal","min":0,"description_tooltip":null,"_model_module":"@jupyter-widgets/controls","layout":"IPY_MODEL_14b4948b7d1a436995f911220c81911d"}},"41ae02a4ae9d454fab2a632d2a9754af":{"model_module":"@jupyter-widgets/controls","model_name":"HTMLModel","state":{"_view_name":"HTMLView","style":"IPY_MODEL_11cf0f4eda4648509c6ca806f69d7f64","_dom_classes":[],"description":"","_model_name":"HTMLModel","placeholder":"​","_view_module":"@jupyter-widgets/controls","_model_module_version":"1.5.0","value":" 4423680/? [00:01&lt;00:00, 2989218.52it/s]","_view_count":null,"_view_module_version":"1.5.0","description_tooltip":null,"_model_module":"@jupyter-widgets/controls","layout":"IPY_MODEL_2ba2f3c013d7462e936de9c182770374"}},"84d5052f9bea4336b690475409cbef97":{"model_module":"@jupyter-widgets/controls","model_name":"ProgressStyleModel","state":{"_view_name":"StyleView","_model_name":"ProgressStyleModel","description_width":"initial","_view_module":"@jupyter-widgets/base","_model_module_version":"1.5.0","_view_count":null,"_view_module_version":"1.2.0","bar_color":null,"_model_module":"@jupyter-widgets/controls"}},"14b4948b7d1a436995f911220c81911d":{"model_module":"@jupyter-widgets/base","model_name":"LayoutModel","state":{"_view_name":"LayoutView","grid_template_rows":null,"right":null,"justify_content":null,"_view_module":"@jupyter-widgets/base","overflow":null,"_model_module_version":"1.2.0","_view_count":null,"flex_flow":null,"width":null,"min_width":null,"border":null,"align_items":null,"bottom":null,"_model_module":"@jupyter-widgets/base","top":null,"grid_column":null,"overflow_y":null,"overflow_x":null,"grid_auto_flow":null,"grid_area":null,"grid_template_columns":null,"flex":null,"_model_name":"LayoutModel","justify_items":null,"grid_row":null,"max_height":null,"align_content":null,"visibility":null,"align_self":null,"height":null,"min_height":null,"padding":null,"grid_auto_rows":null,"grid_gap":null,"max_width":null,"order":null,"_view_module_version":"1.2.0","grid_template_areas":null,"object_position":null,"object_fit":null,"grid_auto_columns":null,"margin":null,"display":null,"left":null}},"11cf0f4eda4648509c6ca806f69d7f64":{"model_module":"@jupyter-widgets/controls","model_name":"DescriptionStyleModel","state":{"_view_name":"StyleView","_model_name":"DescriptionStyleModel","description_width":"","_view_module":"@jupyter-widgets/base","_model_module_version":"1.5.0","_view_count":null,"_view_module_version":"1.2.0","_model_module":"@jupyter-widgets/controls"}},"2ba2f3c013d7462e936de9c182770374":{"model_module":"@jupyter-widgets/base","model_name":"LayoutModel","state":{"_view_name":"LayoutView","grid_template_rows":null,"right":null,"justify_content":null,"_view_module":"@jupyter-widgets/base","overflow":null,"_model_module_version":"1.2.0","_view_count":null,"flex_flow":null,"width":null,"min_width":null,"border":null,"align_items":null,"bottom":null,"_model_module":"@jupyter-widgets/base","top":null,"grid_column":null,"overflow_y":null,"overflow_x":null,"grid_auto_flow":null,"grid_area":null,"grid_template_columns":null,"flex":null,"_model_name":"LayoutModel","justify_items":null,"grid_row":null,"max_height":null,"align_content":null,"visibility":null,"align_self":null,"height":null,"min_height":null,"padding":null,"grid_auto_rows":null,"grid_gap":null,"max_width":null,"order":null,"_view_module_version":"1.2.0","grid_template_areas":null,"object_position":null,"object_fit":null,"grid_auto_columns":null,"margin":null,"display":null,"left":null}},"883426ce1301436987bd8d7151130e18":{"model_module":"@jupyter-widgets/controls","model_name":"HBoxModel","state":{"_view_name":"HBoxView","_dom_classes":[],"_model_name":"HBoxModel","_view_module":"@jupyter-widgets/controls","_model_module_version":"1.5.0","_view_count":null,"_view_module_version":"1.5.0","box_style":"","layout":"IPY_MODEL_87244dd937ef46aaae612fe1737ea1b3","_model_module":"@jupyter-widgets/controls","children":["IPY_MODEL_42268c6ad53c4f4caabc933942211f9a","IPY_MODEL_90669772299142dbb3d420819a676482"]}},"87244dd937ef46aaae612fe1737ea1b3":{"model_module":"@jupyter-widgets/base","model_name":"LayoutModel","state":{"_view_name":"LayoutView","grid_template_rows":null,"right":null,"justify_content":null,"_view_module":"@jupyter-widgets/base","overflow":null,"_model_module_version":"1.2.0","_view_count":null,"flex_flow":null,"width":null,"min_width":null,"border":null,"align_items":null,"bottom":null,"_model_module":"@jupyter-widgets/base","top":null,"grid_column":null,"overflow_y":null,"overflow_x":null,"grid_auto_flow":null,"grid_area":null,"grid_template_columns":null,"flex":null,"_model_name":"LayoutModel","justify_items":null,"grid_row":null,"max_height":null,"align_content":null,"visibility":null,"align_self":null,"height":null,"min_height":null,"padding":null,"grid_auto_rows":null,"grid_gap":null,"max_width":null,"order":null,"_view_module_version":"1.2.0","grid_template_areas":null,"object_position":null,"object_fit":null,"grid_auto_columns":null,"margin":null,"display":null,"left":null}},"42268c6ad53c4f4caabc933942211f9a":{"model_module":"@jupyter-widgets/controls","model_name":"FloatProgressModel","state":{"_view_name":"ProgressView","style":"IPY_MODEL_07b7aa44f0204c4a9bb2601068f716c1","_dom_classes":[],"description":"","_model_name":"FloatProgressModel","bar_style":"success","max":1,"_view_module":"@jupyter-widgets/controls","_model_module_version":"1.5.0","value":1,"_view_count":null,"_view_module_version":"1.5.0","orientation":"horizontal","min":0,"description_tooltip":null,"_model_module":"@jupyter-widgets/controls","layout":"IPY_MODEL_b676b2dcddfd441c80c55d1b33fd9249"}},"90669772299142dbb3d420819a676482":{"model_module":"@jupyter-widgets/controls","model_name":"HTMLModel","state":{"_view_name":"HTMLView","style":"IPY_MODEL_6c7f1a2aeeb5490aa12680058fb15bef","_dom_classes":[],"description":"","_model_name":"HTMLModel","placeholder":"​","_view_module":"@jupyter-widgets/controls","_model_module_version":"1.5.0","value":" 8192/? [00:00&lt;00:00, 23572.57it/s]","_view_count":null,"_view_module_version":"1.5.0","description_tooltip":null,"_model_module":"@jupyter-widgets/controls","layout":"IPY_MODEL_ecaa2985deb24b04b5121e9023b09682"}},"07b7aa44f0204c4a9bb2601068f716c1":{"model_module":"@jupyter-widgets/controls","model_name":"ProgressStyleModel","state":{"_view_name":"StyleView","_model_name":"ProgressStyleModel","description_width":"initial","_view_module":"@jupyter-widgets/base","_model_module_version":"1.5.0","_view_count":null,"_view_module_version":"1.2.0","bar_color":null,"_model_module":"@jupyter-widgets/controls"}},"b676b2dcddfd441c80c55d1b33fd9249":{"model_module":"@jupyter-widgets/base","model_name":"LayoutModel","state":{"_view_name":"LayoutView","grid_template_rows":null,"right":null,"justify_content":null,"_view_module":"@jupyter-widgets/base","overflow":null,"_model_module_version":"1.2.0","_view_count":null,"flex_flow":null,"width":null,"min_width":null,"border":null,"align_items":null,"bottom":null,"_model_module":"@jupyter-widgets/base","top":null,"grid_column":null,"overflow_y":null,"overflow_x":null,"grid_auto_flow":null,"grid_area":null,"grid_template_columns":null,"flex":null,"_model_name":"LayoutModel","justify_items":null,"grid_row":null,"max_height":null,"align_content":null,"visibility":null,"align_self":null,"height":null,"min_height":null,"padding":null,"grid_auto_rows":null,"grid_gap":null,"max_width":null,"order":null,"_view_module_version":"1.2.0","grid_template_areas":null,"object_position":null,"object_fit":null,"grid_auto_columns":null,"margin":null,"display":null,"left":null}},"6c7f1a2aeeb5490aa12680058fb15bef":{"model_module":"@jupyter-widgets/controls","model_name":"DescriptionStyleModel","state":{"_view_name":"StyleView","_model_name":"DescriptionStyleModel","description_width":"","_view_module":"@jupyter-widgets/base","_model_module_version":"1.5.0","_view_count":null,"_view_module_version":"1.2.0","_model_module":"@jupyter-widgets/controls"}},"ecaa2985deb24b04b5121e9023b09682":{"model_module":"@jupyter-widgets/base","model_name":"LayoutModel","state":{"_view_name":"LayoutView","grid_template_rows":null,"right":null,"justify_content":null,"_view_module":"@jupyter-widgets/base","overflow":null,"_model_module_version":"1.2.0","_view_count":null,"flex_flow":null,"width":null,"min_width":null,"border":null,"align_items":null,"bottom":null,"_model_module":"@jupyter-widgets/base","top":null,"grid_column":null,"overflow_y":null,"overflow_x":null,"grid_auto_flow":null,"grid_area":null,"grid_template_columns":null,"flex":null,"_model_name":"LayoutModel","justify_items":null,"grid_row":null,"max_height":null,"align_content":null,"visibility":null,"align_self":null,"height":null,"min_height":null,"padding":null,"grid_auto_rows":null,"grid_gap":null,"max_width":null,"order":null,"_view_module_version":"1.2.0","grid_template_areas":null,"object_position":null,"object_fit":null,"grid_auto_columns":null,"margin":null,"display":null,"left":null}}}}},"cells":[{"cell_type":"markdown","metadata":{"id":"5XDWyysdJKLy","colab_type":"text"},"source":["### 문제\n","\n","- 1layer NN (Perceptron)\n","- SGD optim을 이용한 손글씨 분류기"]},{"cell_type":"code","metadata":{"id":"GAH0HtiGpEc4","colab_type":"code","colab":{"base_uri":"https://localhost:8080/","height":570},"executionInfo":{"status":"ok","timestamp":1593426897108,"user_tz":-540,"elapsed":23144,"user":{"displayName":"Juhee","photoUrl":"","userId":"14369088239483395487"}},"outputId":"28eb9eb5-29fb-436e-b4fa-dfe468d4b3d2"},"source":["!pip uninstall -y kaggle\n","!pip install --upgrade pip\n","!pip install kaggle==1.5.6"],"execution_count":1,"outputs":[{"output_type":"stream","text":["Uninstalling kaggle-1.5.6:\n","  Successfully uninstalled kaggle-1.5.6\n","Collecting pip\n","\u001b[?25l  Downloading https://files.pythonhosted.org/packages/43/84/23ed6a1796480a6f1a2d38f2802901d078266bda38388954d01d3f2e821d/pip-20.1.1-py2.py3-none-any.whl (1.5MB)\n","\u001b[K     |████████████████████████████████| 1.5MB 2.8MB/s \n","\u001b[?25hInstalling collected packages: pip\n","  Found existing installation: pip 19.3.1\n","    Uninstalling pip-19.3.1:\n","      Successfully uninstalled pip-19.3.1\n","Successfully installed pip-20.1.1\n","Collecting kaggle==1.5.6\n","  Downloading kaggle-1.5.6.tar.gz (58 kB)\n","\u001b[K     |████████████████████████████████| 58 kB 1.7 MB/s \n","\u001b[?25hRequirement already satisfied: urllib3<1.25,>=1.21.1 in /usr/local/lib/python3.6/dist-packages (from kaggle==1.5.6) (1.24.3)\n","Requirement already satisfied: six>=1.10 in /usr/local/lib/python3.6/dist-packages (from kaggle==1.5.6) (1.12.0)\n","Requirement already satisfied: certifi in /usr/local/lib/python3.6/dist-packages (from kaggle==1.5.6) (2020.6.20)\n","Requirement already satisfied: python-dateutil in /usr/local/lib/python3.6/dist-packages (from kaggle==1.5.6) (2.8.1)\n","Requirement already satisfied: requests in /usr/local/lib/python3.6/dist-packages (from kaggle==1.5.6) (2.23.0)\n","Requirement already satisfied: tqdm in /usr/local/lib/python3.6/dist-packages (from kaggle==1.5.6) (4.41.1)\n","Requirement already satisfied: python-slugify in /usr/local/lib/python3.6/dist-packages (from kaggle==1.5.6) (4.0.0)\n","Requirement already satisfied: idna<3,>=2.5 in /usr/local/lib/python3.6/dist-packages (from requests->kaggle==1.5.6) (2.9)\n","Requirement already satisfied: chardet<4,>=3.0.2 in /usr/local/lib/python3.6/dist-packages (from requests->kaggle==1.5.6) (3.0.4)\n","Requirement already satisfied: text-unidecode>=1.3 in /usr/local/lib/python3.6/dist-packages (from python-slugify->kaggle==1.5.6) (1.3)\n","Building wheels for collected packages: kaggle\n","  Building wheel for kaggle (setup.py) ... \u001b[?25l\u001b[?25hdone\n","  Created wheel for kaggle: filename=kaggle-1.5.6-py3-none-any.whl size=72859 sha256=71045f5fc4d3fe0da629fa81a3c51efe8ef0d5b8f14a6e2c6351807fc24b73c0\n","  Stored in directory: /root/.cache/pip/wheels/01/3e/ff/77407ebac3ef71a79b9166a8382aecf88415a0bcbe3c095a01\n","Successfully built kaggle\n","Installing collected packages: kaggle\n","Successfully installed kaggle-1.5.6\n"],"name":"stdout"}]},{"cell_type":"code","metadata":{"id":"mP1Pfyz_pEOG","colab_type":"code","colab":{"base_uri":"https://localhost:8080/","height":35},"executionInfo":{"status":"ok","timestamp":1593426924258,"user_tz":-540,"elapsed":15278,"user":{"displayName":"Juhee","photoUrl":"","userId":"14369088239483395487"}},"outputId":"0cf5f2d6-b522-4673-ce29-f607fcc3be09"},"source":["!mkdir -p ~/.kaggle\n","!cp kaggle.json ~/.kaggle\n","!ls -lha kaggle.json\n","!chmod 600 ~/.kaggle/kaggle.json"],"execution_count":2,"outputs":[{"output_type":"stream","text":["-rw-r--r-- 1 root root 64 Jun 29 10:34 kaggle.json\n"],"name":"stdout"}]},{"cell_type":"code","metadata":{"id":"E7idjNImpSEU","colab_type":"code","colab":{"base_uri":"https://localhost:8080/","height":141},"executionInfo":{"status":"ok","timestamp":1593426954980,"user_tz":-540,"elapsed":7782,"user":{"displayName":"Juhee","photoUrl":"","userId":"14369088239483395487"}},"outputId":"78667aa8-73bc-416a-9c04-5d115f59bb41"},"source":["!kaggle competitions download -c 2020-ai-exam-fashionmnist-1\n","!unzip 2020-ai-exam-fashionmnist-1.zip"],"execution_count":3,"outputs":[{"output_type":"stream","text":["Downloading 2020-ai-exam-fashionmnist-1.zip to /content\n"," 82% 32.0M/39.2M [00:00<00:00, 130MB/s]\n","100% 39.2M/39.2M [00:00<00:00, 177MB/s]\n","Archive:  2020-ai-exam-fashionmnist-1.zip\n","  inflating: mnist_test.csv          \n","  inflating: mnist_train_label.csv   \n","  inflating: submission.csv          \n"],"name":"stdout"}]},{"cell_type":"code","metadata":{"id":"Y3bpvTNIRwWl","colab_type":"code","colab":{},"executionInfo":{"status":"ok","timestamp":1593427010424,"user_tz":-540,"elapsed":917,"user":{"displayName":"Juhee","photoUrl":"","userId":"14369088239483395487"}}},"source":["import torch                                \n","import torchvision.datasets            # torchvision을 이용해 dataset을 불러옴\n","import torchvision.transforms as transforms\n","import random"],"execution_count":7,"outputs":[]},{"cell_type":"code","metadata":{"id":"S8NIzQqXpR1E","colab_type":"code","colab":{},"executionInfo":{"status":"ok","timestamp":1593426983581,"user_tz":-540,"elapsed":3352,"user":{"displayName":"Juhee","photoUrl":"","userId":"14369088239483395487"}}},"source":[""],"execution_count":4,"outputs":[]},{"cell_type":"code","metadata":{"id":"QICWFIJUR6PL","colab_type":"code","colab":{},"executionInfo":{"status":"ok","timestamp":1593426983590,"user_tz":-540,"elapsed":3033,"user":{"displayName":"Juhee","photoUrl":"","userId":"14369088239483395487"}}},"source":["# GPU 사용\n","\n","device = 'cuda' if torch.cuda.is_available() else 'cpu' # GPU가 내 시스템에 없다면 CPU를 사용하겠다.\n","\n"," # 실험 반복시마다 동일한 값을 생성하기 위해 \n"," # 3개의 랜덤 seed고정\n","\n","random.seed(777)                   \n","torch.manual_seed(777)              \n","if device == 'cuda':\n","  torch.cuda.manual_seed_all(777)"],"execution_count":5,"outputs":[]},{"cell_type":"code","metadata":{"id":"gh_Yz21HVs0V","colab_type":"code","colab":{},"executionInfo":{"status":"ok","timestamp":1593426983593,"user_tz":-540,"elapsed":1179,"user":{"displayName":"Juhee","photoUrl":"","userId":"14369088239483395487"}}},"source":["\n","# 학습 파라미터 설정\n","learning_rate = 0.001\n","training_epochs = 15\n","batch_size = 100"],"execution_count":6,"outputs":[]},{"cell_type":"markdown","metadata":{"id":"Vp-n_5AU2hyR","colab_type":"text"},"source":["\n","- root: 저장경로\n","- 학습/테스트 데이터 선택: True 학습데이터\n","- transform:\n","- download: \n"]},{"cell_type":"code","metadata":{"id":"vIwHRJNlsjqq","colab_type":"code","colab":{}},"source":["train_data=pd.read_csv('mnist_train.csv',header=None,skiprows=1, usecols=range(1,786))\n","test_data=pd.read_csv('mnist_test.csv',header=None,skiprows=1, usecols=range(1,785))"],"execution_count":null,"outputs":[]},{"cell_type":"code","metadata":{"id":"9EVz_27QV_AJ","colab_type":"code","colab":{"base_uri":"https://localhost:8080/","height":414,"referenced_widgets":["c921043ccce94cb9adb061444dbc16f3","afa564afc3b248d7bd11c18aaf0ae875","37cdb831c73f4743a7c4cb4f3c6276e4","606c911715f546449562c410cf03b82b","2769768b20fd42d0b91bfb3e0a4b6f3b","40cc35632b6a47d2a6af66636e61f75f","5fa4157af22245e8ad211b6d00035375","8b3bb95244f44f8e9a85574736c9c299","864f2d78a279441e8650d7606c487d1f","60ed340119a34f2db0299eef409d5c99","8d84a252878e4e0c92d2f1fe17a6d990","44e46d4c36134a989904f44047361be0","f78a13ee60f2472cb2bbc87c40c37854","d9fac0bce0d04fa18acc720c54725003","6a234fa9b50445d6a3b3a06bf93c87df","99fe4151fded434ca5edbe663e2f805c","6c49c79ac9dd4afcb123eb425ca400a2","769c685125ac43fcbb5e088d75df8421","f88d31ceae9548d4bffea960f31d73f2","41ae02a4ae9d454fab2a632d2a9754af","84d5052f9bea4336b690475409cbef97","14b4948b7d1a436995f911220c81911d","11cf0f4eda4648509c6ca806f69d7f64","2ba2f3c013d7462e936de9c182770374","883426ce1301436987bd8d7151130e18","87244dd937ef46aaae612fe1737ea1b3","42268c6ad53c4f4caabc933942211f9a","90669772299142dbb3d420819a676482","07b7aa44f0204c4a9bb2601068f716c1","b676b2dcddfd441c80c55d1b33fd9249","6c7f1a2aeeb5490aa12680058fb15bef","ecaa2985deb24b04b5121e9023b09682"]},"executionInfo":{"status":"ok","timestamp":1593427074596,"user_tz":-540,"elapsed":5195,"user":{"displayName":"Juhee","photoUrl":"","userId":"14369088239483395487"}},"outputId":"6b359fc7-bcb0-43db-92de-fb09dd50376a"},"source":["mnist_train = torchvision.datasets.FashionMNIST(root='data/',\n","                         train=True,                          # train데이터를 받는지\n","                         transform=transforms.ToTensor(),     # tensor로 데이터를 받겠다.\n","                         download=True)                       # 데이터셋이 없다면 down받아달라는 의미\n","\n","# test데이터를 받기 위해서는 train=False\n","mnist_test = torchvision.datasets.FashionMNIST(root='data/',\n","                         train=False,\n","                         transform=transforms.ToTensor(),\n","                         download=True)"],"execution_count":8,"outputs":[{"output_type":"stream","text":["Downloading http://fashion-mnist.s3-website.eu-central-1.amazonaws.com/train-images-idx3-ubyte.gz to data/FashionMNIST/raw/train-images-idx3-ubyte.gz\n"],"name":"stdout"},{"output_type":"display_data","data":{"application/vnd.jupyter.widget-view+json":{"model_id":"c921043ccce94cb9adb061444dbc16f3","version_minor":0,"version_major":2},"text/plain":["HBox(children=(FloatProgress(value=1.0, bar_style='info', max=1.0), HTML(value='')))"]},"metadata":{"tags":[]}},{"output_type":"stream","text":["Extracting data/FashionMNIST/raw/train-images-idx3-ubyte.gz to data/FashionMNIST/raw\n","Downloading http://fashion-mnist.s3-website.eu-central-1.amazonaws.com/train-labels-idx1-ubyte.gz to data/FashionMNIST/raw/train-labels-idx1-ubyte.gz\n"],"name":"stdout"},{"output_type":"display_data","data":{"application/vnd.jupyter.widget-view+json":{"model_id":"864f2d78a279441e8650d7606c487d1f","version_minor":0,"version_major":2},"text/plain":["HBox(children=(FloatProgress(value=1.0, bar_style='info', max=1.0), HTML(value='')))"]},"metadata":{"tags":[]}},{"output_type":"stream","text":["Extracting data/FashionMNIST/raw/train-labels-idx1-ubyte.gz to data/FashionMNIST/raw\n","Downloading http://fashion-mnist.s3-website.eu-central-1.amazonaws.com/t10k-images-idx3-ubyte.gz to data/FashionMNIST/raw/t10k-images-idx3-ubyte.gz\n"],"name":"stdout"},{"output_type":"display_data","data":{"application/vnd.jupyter.widget-view+json":{"model_id":"6c49c79ac9dd4afcb123eb425ca400a2","version_minor":0,"version_major":2},"text/plain":["HBox(children=(FloatProgress(value=1.0, bar_style='info', max=1.0), HTML(value='')))"]},"metadata":{"tags":[]}},{"output_type":"stream","text":["Extracting data/FashionMNIST/raw/t10k-images-idx3-ubyte.gz to data/FashionMNIST/raw\n","Downloading http://fashion-mnist.s3-website.eu-central-1.amazonaws.com/t10k-labels-idx1-ubyte.gz to data/FashionMNIST/raw/t10k-labels-idx1-ubyte.gz\n"],"name":"stdout"},{"output_type":"display_data","data":{"application/vnd.jupyter.widget-view+json":{"model_id":"883426ce1301436987bd8d7151130e18","version_minor":0,"version_major":2},"text/plain":["HBox(children=(FloatProgress(value=1.0, bar_style='info', max=1.0), HTML(value='')))"]},"metadata":{"tags":[]}},{"output_type":"stream","text":["Extracting data/FashionMNIST/raw/t10k-labels-idx1-ubyte.gz to data/FashionMNIST/raw\n","Processing...\n","\n","\n","\n"],"name":"stdout"},{"output_type":"stream","text":["/pytorch/torch/csrc/utils/tensor_numpy.cpp:141: UserWarning: The given NumPy array is not writeable, and PyTorch does not support non-writeable tensors. This means you can write to the underlying (supposedly non-writeable) NumPy array using the tensor. You may want to copy the array to protect its data or make it writeable before converting it to a tensor. This type of warning will be suppressed for the rest of this program.\n"],"name":"stderr"},{"output_type":"stream","text":["Done!\n"],"name":"stdout"}]},{"cell_type":"code","metadata":{"id":"-Ae1Q7WXWJcc","colab_type":"code","colab":{},"executionInfo":{"status":"ok","timestamp":1593427506894,"user_tz":-540,"elapsed":851,"user":{"displayName":"Juhee","photoUrl":"","userId":"14369088239483395487"}}},"source":["\n","data_loader = torch.utils.data.DataLoader(dataset=mnist_train,\n","                                          batch_size=batch_size,\n","                                          shuffle=True,\n","                                          drop_last=True)\n","\n","\n","test_loader= torch.utils.data.DataLoader(dataset=mnist_train,\n","                                          batch_size=batch_size,\n","                                          shuffle=True,\n","                                          drop_last=True)\n","# data loader가 batch size에 맞게 데이터를 잘라준다.\n","# 데이터를 섞어서 학습\n","# drop_last: batch size설정 후 남는 데이터를 버릴지 말지 여부"],"execution_count":26,"outputs":[]},{"cell_type":"code","metadata":{"id":"dDPOYi_uqCba","colab_type":"code","colab":{"base_uri":"https://localhost:8080/","height":124},"executionInfo":{"status":"ok","timestamp":1593427122431,"user_tz":-540,"elapsed":849,"user":{"displayName":"Juhee","photoUrl":"","userId":"14369088239483395487"}},"outputId":"d57d51d4-bb4e-40c1-d251-b58292122922"},"source":["mnist_train"],"execution_count":11,"outputs":[{"output_type":"execute_result","data":{"text/plain":["Dataset FashionMNIST\n","    Number of datapoints: 60000\n","    Root location: data/\n","    Split: Train\n","    StandardTransform\n","Transform: ToTensor()"]},"metadata":{"tags":[]},"execution_count":11}]},{"cell_type":"markdown","metadata":{"id":"R0Tk0BBFzOJq","colab_type":"text"},"source":["![대체 텍스트](https://user-images.githubusercontent.com/11758940/83336289-229ec200-a2ed-11ea-9fb8-88a51198e475.png)"]},{"cell_type":"code","metadata":{"id":"ntcrgdljaxST","colab_type":"code","colab":{},"executionInfo":{"status":"ok","timestamp":1593427231655,"user_tz":-540,"elapsed":3501,"user":{"displayName":"Juhee","photoUrl":"","userId":"14369088239483395487"}}},"source":["# layer가 하나이기때문에 입력받아서 출력을 그대로 맞춰준다.\n","\n","linear = torch.nn.Linear(784,10,bias=True)\n","\n","# 출력 10개. one hot encoding"],"execution_count":17,"outputs":[]},{"cell_type":"markdown","metadata":{"id":"OUqE8Uibc4xH","colab_type":"text"},"source":["[메뉴얼] https://pytorch.org/docs/stable/nn.init.html#torch.nn.init.normal_"]},{"cell_type":"code","metadata":{"id":"MrpNg6XycEWE","colab_type":"code","colab":{"base_uri":"https://localhost:8080/","height":177},"executionInfo":{"status":"ok","timestamp":1593427232960,"user_tz":-540,"elapsed":3013,"user":{"displayName":"Juhee","photoUrl":"","userId":"14369088239483395487"}},"outputId":"cc124693-9cf6-4814-f3f2-af3bda4ea652"},"source":["# 신경망 초기화 \n","# init.normal_: 랜덤 initialize 사용 \n","\n","torch.nn.init.normal_(linear.weight)"],"execution_count":18,"outputs":[{"output_type":"execute_result","data":{"text/plain":["Parameter containing:\n","tensor([[ 1.7495,  2.4850,  0.1422,  ...,  0.1513, -2.0204, -0.2145],\n","        [ 1.0809,  1.5023,  0.1162,  ..., -0.7688,  0.2412,  0.5426],\n","        [-0.0480,  1.2797,  0.0089,  ..., -1.5668, -0.7234,  0.2371],\n","        ...,\n","        [-0.5296,  0.4541, -0.6369,  ...,  1.8215, -1.7908,  0.6436],\n","        [-1.1450,  1.2996,  0.0257,  ...,  0.4154, -1.4151,  0.0928],\n","        [-0.0280, -1.5980, -0.1348,  ...,  0.7661,  0.6500,  0.3318]],\n","       requires_grad=True)"]},"metadata":{"tags":[]},"execution_count":18}]},{"cell_type":"code","metadata":{"id":"9k08MAGZ326V","colab_type":"code","colab":{},"executionInfo":{"status":"ok","timestamp":1593427232966,"user_tz":-540,"elapsed":2352,"user":{"displayName":"Juhee","photoUrl":"","userId":"14369088239483395487"}}},"source":["model = torch.nn.Sequential(linear).to(device)  \n","\n","# to(device) = to GPU   'cuda' GPU메모리에 저장했다는 의미"],"execution_count":19,"outputs":[]},{"cell_type":"markdown","metadata":{"id":"fQxCfqMSces5","colab_type":"text"},"source":["[메뉴얼] https://pytorch.org/docs/stable/nn.html#crossentropyloss"]},{"cell_type":"code","metadata":{"id":"o9WQWlFdcKaH","colab_type":"code","colab":{},"executionInfo":{"status":"ok","timestamp":1593427235704,"user_tz":-540,"elapsed":2217,"user":{"displayName":"Juhee","photoUrl":"","userId":"14369088239483395487"}}},"source":["loss = torch.nn.CrossEntropyLoss().to(device)\n","optimizer = torch.optim.SGD(model.parameters(), lr=learning_rate) # 0.49"],"execution_count":20,"outputs":[]},{"cell_type":"code","metadata":{"id":"yQu5p_pTcRFI","colab_type":"code","colab":{"base_uri":"https://localhost:8080/","height":301},"executionInfo":{"status":"ok","timestamp":1593427340853,"user_tz":-540,"elapsed":103543,"user":{"displayName":"Juhee","photoUrl":"","userId":"14369088239483395487"}},"outputId":"a06f47ab-f89e-4971-ab65-508bfb60f371"},"source":["\n","total_batch = len(data_loader)        # mini batch의 크기. 갯수. = 전체데이터/batchsize\n","for epoch in range(training_epochs):  # 전체 데이터 60000개의 학습을 15번 반복\n","    avg_cost = 0\n","\n","    for X, Y in data_loader:          #전체 데이터 60000을 1번 봄. \n","\n","        # (100, 1, 28, 28) 크기의 텐서를 (1000, 784) 크기의 텐서로 변형\n","        # (100은 batch size, )\n","        X = X.view(-1, 28 * 28).to(device)          # view = reshape: 데이터 가공\n","\n","\n","        # one-hot encoding되어 있지 않음\n","        Y = Y.to(device)\n","        #%debug\n","\n","        # 그래디언트 초기화\n","        optimizer.zero_grad()\n","        # Forward 계산\n","        hypothesis = model(X)         #예측된 결과\n","        # Error 계산\n","        cost = loss(hypothesis, Y)    # 실제 값과의 오차\n","        # Backparopagation\n","        cost.backward()\n","        # 가중치 갱신\n","        optimizer.step()\n","\n","        # 평균 Error 계산\n","        avg_cost += cost / total_batch\n","\n","    print('Epoch:', '%04d' % (epoch + 1), 'cost =', '{:.9f}'.format(avg_cost))\n","\n","print('Learning finished')"],"execution_count":21,"outputs":[{"output_type":"stream","text":["Epoch: 0001 cost = 14.414995193\n","Epoch: 0002 cost = 10.622673988\n","Epoch: 0003 cost = 8.583692551\n","Epoch: 0004 cost = 6.981877804\n","Epoch: 0005 cost = 5.799039841\n","Epoch: 0006 cost = 5.134186268\n","Epoch: 0007 cost = 4.711555481\n","Epoch: 0008 cost = 4.384190559\n","Epoch: 0009 cost = 4.120818138\n","Epoch: 0010 cost = 3.904816866\n","Epoch: 0011 cost = 3.724475145\n","Epoch: 0012 cost = 3.571537495\n","Epoch: 0013 cost = 3.439971209\n","Epoch: 0014 cost = 3.325371265\n","Epoch: 0015 cost = 3.224339962\n","Learning finished\n"],"name":"stdout"}]},{"cell_type":"markdown","metadata":{"id":"QhuT6ATySfgq","colab_type":"text"},"source":["## 성능확인"]},{"cell_type":"code","metadata":{"id":"gavgUJQmsNwA","colab_type":"code","colab":{"base_uri":"https://localhost:8080/","height":188},"executionInfo":{"status":"error","timestamp":1593427720015,"user_tz":-540,"elapsed":699,"user":{"displayName":"Juhee","photoUrl":"","userId":"14369088239483395487"}},"outputId":"3d174fa6-cfed-4f37-ed29-682493745001"},"source":["test_data=pd.read_csv(\"mnist_test\")\n","test_data"],"execution_count":31,"outputs":[{"output_type":"error","ename":"NameError","evalue":"ignored","traceback":["\u001b[0;31m---------------------------------------------------------------------------\u001b[0m","\u001b[0;31mNameError\u001b[0m                                 Traceback (most recent call last)","\u001b[0;32m<ipython-input-31-777890b47fb8>\u001b[0m in \u001b[0;36m<module>\u001b[0;34m()\u001b[0m\n\u001b[0;32m----> 1\u001b[0;31m \u001b[0mtest_data\u001b[0m\u001b[0;34m=\u001b[0m\u001b[0mpd\u001b[0m\u001b[0;34m.\u001b[0m\u001b[0mread_csv\u001b[0m\u001b[0;34m(\u001b[0m\u001b[0;34m\"mnist_test\"\u001b[0m\u001b[0;34m)\u001b[0m\u001b[0;34m\u001b[0m\u001b[0;34m\u001b[0m\u001b[0m\n\u001b[0m\u001b[1;32m      2\u001b[0m \u001b[0mtest_data\u001b[0m\u001b[0;34m\u001b[0m\u001b[0;34m\u001b[0m\u001b[0m\n","\u001b[0;31mNameError\u001b[0m: name 'pd' is not defined"]}]},{"cell_type":"code","metadata":{"id":"z_SQp0GxdJfc","colab_type":"code","colab":{"base_uri":"https://localhost:8080/","height":126},"executionInfo":{"status":"ok","timestamp":1593427354023,"user_tz":-540,"elapsed":1750,"user":{"displayName":"Juhee","photoUrl":"","userId":"14369088239483395487"}},"outputId":"ee970038-5856-4ad9-c8cb-9ccab4c87b0b"},"source":["# Test the model using test sets\n","\n","with torch.no_grad():\n","    # flaot() : GPU=>CPU로 데이터 내리기\n","    X_test = mnist_test.test_data.view(-1, 28 * 28).float().to(device)\n","    Y_test = mnist_test.test_labels.to(device)\n","\n","    prediction = model(X_test)    #one hot encoding 상태이므로, 아래에서 argmax를 수행하여 라벨값을 구한다.\n","    correct_prediction = torch.argmax(prediction, 1) == Y_test\n","    accuracy = correct_prediction.float().mean()\n","    print('Accuracy:', accuracy.item())\n"],"execution_count":22,"outputs":[{"output_type":"stream","text":["Accuracy: 0.45659998059272766\n"],"name":"stdout"},{"output_type":"stream","text":["/usr/local/lib/python3.6/dist-packages/torchvision/datasets/mnist.py:60: UserWarning: test_data has been renamed data\n","  warnings.warn(\"test_data has been renamed data\")\n","/usr/local/lib/python3.6/dist-packages/torchvision/datasets/mnist.py:50: UserWarning: test_labels has been renamed targets\n","  warnings.warn(\"test_labels has been renamed targets\")\n"],"name":"stderr"}]},{"cell_type":"code","metadata":{"id":"i425y53v4tvo","colab_type":"code","colab":{"base_uri":"https://localhost:8080/","height":372},"executionInfo":{"status":"error","timestamp":1593427624213,"user_tz":-540,"elapsed":822,"user":{"displayName":"Juhee","photoUrl":"","userId":"14369088239483395487"}},"outputId":"29f2a6c4-8b0c-4f1d-9514-6c4f6963604b"},"source":["# Test the model using test sets\n","with torch.no_grad():\n","  model.eval()\n","  x_test_data=test_data.loc[:,:]\n","  x_test_data=np.array(x_test_data)\n","  x_test_data=torch.from_numpy(x_test_data).float().to(device)\n","\n","  prediction = model(x_test_data)\n","  correct_prediction = torch.argmax(prediction, 1)"],"execution_count":30,"outputs":[{"output_type":"error","ename":"AttributeError","evalue":"ignored","traceback":["\u001b[0;31m---------------------------------------------------------------------------\u001b[0m","\u001b[0;31mAttributeError\u001b[0m                            Traceback (most recent call last)","\u001b[0;32m<ipython-input-30-36a5e6d3bc98>\u001b[0m in \u001b[0;36m<module>\u001b[0;34m()\u001b[0m\n\u001b[1;32m      7\u001b[0m  \u001b[0;31m# x_test_data=torch.from_numpy(x_test_data).float().to(device)\u001b[0m\u001b[0;34m\u001b[0m\u001b[0;34m\u001b[0m\u001b[0;34m\u001b[0m\u001b[0m\n\u001b[1;32m      8\u001b[0m \u001b[0;34m\u001b[0m\u001b[0m\n\u001b[0;32m----> 9\u001b[0;31m   \u001b[0mprediction\u001b[0m \u001b[0;34m=\u001b[0m \u001b[0mmodel\u001b[0m\u001b[0;34m(\u001b[0m\u001b[0mx_test_data\u001b[0m\u001b[0;34m)\u001b[0m\u001b[0;34m\u001b[0m\u001b[0;34m\u001b[0m\u001b[0m\n\u001b[0m\u001b[1;32m     10\u001b[0m   \u001b[0mcorrect_prediction\u001b[0m \u001b[0;34m=\u001b[0m \u001b[0mtorch\u001b[0m\u001b[0;34m.\u001b[0m\u001b[0margmax\u001b[0m\u001b[0;34m(\u001b[0m\u001b[0mprediction\u001b[0m\u001b[0;34m,\u001b[0m \u001b[0;36m1\u001b[0m\u001b[0;34m)\u001b[0m\u001b[0;34m\u001b[0m\u001b[0;34m\u001b[0m\u001b[0m\n","\u001b[0;32m/usr/local/lib/python3.6/dist-packages/torch/nn/modules/module.py\u001b[0m in \u001b[0;36m__call__\u001b[0;34m(self, *input, **kwargs)\u001b[0m\n\u001b[1;32m    548\u001b[0m             \u001b[0mresult\u001b[0m \u001b[0;34m=\u001b[0m \u001b[0mself\u001b[0m\u001b[0;34m.\u001b[0m\u001b[0m_slow_forward\u001b[0m\u001b[0;34m(\u001b[0m\u001b[0;34m*\u001b[0m\u001b[0minput\u001b[0m\u001b[0;34m,\u001b[0m \u001b[0;34m**\u001b[0m\u001b[0mkwargs\u001b[0m\u001b[0;34m)\u001b[0m\u001b[0;34m\u001b[0m\u001b[0;34m\u001b[0m\u001b[0m\n\u001b[1;32m    549\u001b[0m         \u001b[0;32melse\u001b[0m\u001b[0;34m:\u001b[0m\u001b[0;34m\u001b[0m\u001b[0;34m\u001b[0m\u001b[0m\n\u001b[0;32m--> 550\u001b[0;31m             \u001b[0mresult\u001b[0m \u001b[0;34m=\u001b[0m \u001b[0mself\u001b[0m\u001b[0;34m.\u001b[0m\u001b[0mforward\u001b[0m\u001b[0;34m(\u001b[0m\u001b[0;34m*\u001b[0m\u001b[0minput\u001b[0m\u001b[0;34m,\u001b[0m \u001b[0;34m**\u001b[0m\u001b[0mkwargs\u001b[0m\u001b[0;34m)\u001b[0m\u001b[0;34m\u001b[0m\u001b[0;34m\u001b[0m\u001b[0m\n\u001b[0m\u001b[1;32m    551\u001b[0m         \u001b[0;32mfor\u001b[0m \u001b[0mhook\u001b[0m \u001b[0;32min\u001b[0m \u001b[0mself\u001b[0m\u001b[0;34m.\u001b[0m\u001b[0m_forward_hooks\u001b[0m\u001b[0;34m.\u001b[0m\u001b[0mvalues\u001b[0m\u001b[0;34m(\u001b[0m\u001b[0;34m)\u001b[0m\u001b[0;34m:\u001b[0m\u001b[0;34m\u001b[0m\u001b[0;34m\u001b[0m\u001b[0m\n\u001b[1;32m    552\u001b[0m             \u001b[0mhook_result\u001b[0m \u001b[0;34m=\u001b[0m \u001b[0mhook\u001b[0m\u001b[0;34m(\u001b[0m\u001b[0mself\u001b[0m\u001b[0;34m,\u001b[0m \u001b[0minput\u001b[0m\u001b[0;34m,\u001b[0m \u001b[0mresult\u001b[0m\u001b[0;34m)\u001b[0m\u001b[0;34m\u001b[0m\u001b[0;34m\u001b[0m\u001b[0m\n","\u001b[0;32m/usr/local/lib/python3.6/dist-packages/torch/nn/modules/container.py\u001b[0m in \u001b[0;36mforward\u001b[0;34m(self, input)\u001b[0m\n\u001b[1;32m     98\u001b[0m     \u001b[0;32mdef\u001b[0m \u001b[0mforward\u001b[0m\u001b[0;34m(\u001b[0m\u001b[0mself\u001b[0m\u001b[0;34m,\u001b[0m \u001b[0minput\u001b[0m\u001b[0;34m)\u001b[0m\u001b[0;34m:\u001b[0m\u001b[0;34m\u001b[0m\u001b[0;34m\u001b[0m\u001b[0m\n\u001b[1;32m     99\u001b[0m         \u001b[0;32mfor\u001b[0m \u001b[0mmodule\u001b[0m \u001b[0;32min\u001b[0m \u001b[0mself\u001b[0m\u001b[0;34m:\u001b[0m\u001b[0;34m\u001b[0m\u001b[0;34m\u001b[0m\u001b[0m\n\u001b[0;32m--> 100\u001b[0;31m             \u001b[0minput\u001b[0m \u001b[0;34m=\u001b[0m \u001b[0mmodule\u001b[0m\u001b[0;34m(\u001b[0m\u001b[0minput\u001b[0m\u001b[0;34m)\u001b[0m\u001b[0;34m\u001b[0m\u001b[0;34m\u001b[0m\u001b[0m\n\u001b[0m\u001b[1;32m    101\u001b[0m         \u001b[0;32mreturn\u001b[0m \u001b[0minput\u001b[0m\u001b[0;34m\u001b[0m\u001b[0;34m\u001b[0m\u001b[0m\n\u001b[1;32m    102\u001b[0m \u001b[0;34m\u001b[0m\u001b[0m\n","\u001b[0;32m/usr/local/lib/python3.6/dist-packages/torch/nn/modules/module.py\u001b[0m in \u001b[0;36m__call__\u001b[0;34m(self, *input, **kwargs)\u001b[0m\n\u001b[1;32m    548\u001b[0m             \u001b[0mresult\u001b[0m \u001b[0;34m=\u001b[0m \u001b[0mself\u001b[0m\u001b[0;34m.\u001b[0m\u001b[0m_slow_forward\u001b[0m\u001b[0;34m(\u001b[0m\u001b[0;34m*\u001b[0m\u001b[0minput\u001b[0m\u001b[0;34m,\u001b[0m \u001b[0;34m**\u001b[0m\u001b[0mkwargs\u001b[0m\u001b[0;34m)\u001b[0m\u001b[0;34m\u001b[0m\u001b[0;34m\u001b[0m\u001b[0m\n\u001b[1;32m    549\u001b[0m         \u001b[0;32melse\u001b[0m\u001b[0;34m:\u001b[0m\u001b[0;34m\u001b[0m\u001b[0;34m\u001b[0m\u001b[0m\n\u001b[0;32m--> 550\u001b[0;31m             \u001b[0mresult\u001b[0m \u001b[0;34m=\u001b[0m \u001b[0mself\u001b[0m\u001b[0;34m.\u001b[0m\u001b[0mforward\u001b[0m\u001b[0;34m(\u001b[0m\u001b[0;34m*\u001b[0m\u001b[0minput\u001b[0m\u001b[0;34m,\u001b[0m \u001b[0;34m**\u001b[0m\u001b[0mkwargs\u001b[0m\u001b[0;34m)\u001b[0m\u001b[0;34m\u001b[0m\u001b[0;34m\u001b[0m\u001b[0m\n\u001b[0m\u001b[1;32m    551\u001b[0m         \u001b[0;32mfor\u001b[0m \u001b[0mhook\u001b[0m \u001b[0;32min\u001b[0m \u001b[0mself\u001b[0m\u001b[0;34m.\u001b[0m\u001b[0m_forward_hooks\u001b[0m\u001b[0;34m.\u001b[0m\u001b[0mvalues\u001b[0m\u001b[0;34m(\u001b[0m\u001b[0;34m)\u001b[0m\u001b[0;34m:\u001b[0m\u001b[0;34m\u001b[0m\u001b[0;34m\u001b[0m\u001b[0m\n\u001b[1;32m    552\u001b[0m             \u001b[0mhook_result\u001b[0m \u001b[0;34m=\u001b[0m \u001b[0mhook\u001b[0m\u001b[0;34m(\u001b[0m\u001b[0mself\u001b[0m\u001b[0;34m,\u001b[0m \u001b[0minput\u001b[0m\u001b[0;34m,\u001b[0m \u001b[0mresult\u001b[0m\u001b[0;34m)\u001b[0m\u001b[0;34m\u001b[0m\u001b[0;34m\u001b[0m\u001b[0m\n","\u001b[0;32m/usr/local/lib/python3.6/dist-packages/torch/nn/modules/linear.py\u001b[0m in \u001b[0;36mforward\u001b[0;34m(self, input)\u001b[0m\n\u001b[1;32m     85\u001b[0m \u001b[0;34m\u001b[0m\u001b[0m\n\u001b[1;32m     86\u001b[0m     \u001b[0;32mdef\u001b[0m \u001b[0mforward\u001b[0m\u001b[0;34m(\u001b[0m\u001b[0mself\u001b[0m\u001b[0;34m,\u001b[0m \u001b[0minput\u001b[0m\u001b[0;34m)\u001b[0m\u001b[0;34m:\u001b[0m\u001b[0;34m\u001b[0m\u001b[0;34m\u001b[0m\u001b[0m\n\u001b[0;32m---> 87\u001b[0;31m         \u001b[0;32mreturn\u001b[0m \u001b[0mF\u001b[0m\u001b[0;34m.\u001b[0m\u001b[0mlinear\u001b[0m\u001b[0;34m(\u001b[0m\u001b[0minput\u001b[0m\u001b[0;34m,\u001b[0m \u001b[0mself\u001b[0m\u001b[0;34m.\u001b[0m\u001b[0mweight\u001b[0m\u001b[0;34m,\u001b[0m \u001b[0mself\u001b[0m\u001b[0;34m.\u001b[0m\u001b[0mbias\u001b[0m\u001b[0;34m)\u001b[0m\u001b[0;34m\u001b[0m\u001b[0;34m\u001b[0m\u001b[0m\n\u001b[0m\u001b[1;32m     88\u001b[0m \u001b[0;34m\u001b[0m\u001b[0m\n\u001b[1;32m     89\u001b[0m     \u001b[0;32mdef\u001b[0m \u001b[0mextra_repr\u001b[0m\u001b[0;34m(\u001b[0m\u001b[0mself\u001b[0m\u001b[0;34m)\u001b[0m\u001b[0;34m:\u001b[0m\u001b[0;34m\u001b[0m\u001b[0;34m\u001b[0m\u001b[0m\n","\u001b[0;32m/usr/local/lib/python3.6/dist-packages/torch/nn/functional.py\u001b[0m in \u001b[0;36mlinear\u001b[0;34m(input, weight, bias)\u001b[0m\n\u001b[1;32m   1606\u001b[0m         \u001b[0;32mif\u001b[0m \u001b[0many\u001b[0m\u001b[0;34m(\u001b[0m\u001b[0;34m[\u001b[0m\u001b[0mtype\u001b[0m\u001b[0;34m(\u001b[0m\u001b[0mt\u001b[0m\u001b[0;34m)\u001b[0m \u001b[0;32mis\u001b[0m \u001b[0;32mnot\u001b[0m \u001b[0mTensor\u001b[0m \u001b[0;32mfor\u001b[0m \u001b[0mt\u001b[0m \u001b[0;32min\u001b[0m \u001b[0mtens_ops\u001b[0m\u001b[0;34m]\u001b[0m\u001b[0;34m)\u001b[0m \u001b[0;32mand\u001b[0m \u001b[0mhas_torch_function\u001b[0m\u001b[0;34m(\u001b[0m\u001b[0mtens_ops\u001b[0m\u001b[0;34m)\u001b[0m\u001b[0;34m:\u001b[0m\u001b[0;34m\u001b[0m\u001b[0;34m\u001b[0m\u001b[0m\n\u001b[1;32m   1607\u001b[0m             \u001b[0;32mreturn\u001b[0m \u001b[0mhandle_torch_function\u001b[0m\u001b[0;34m(\u001b[0m\u001b[0mlinear\u001b[0m\u001b[0;34m,\u001b[0m \u001b[0mtens_ops\u001b[0m\u001b[0;34m,\u001b[0m \u001b[0minput\u001b[0m\u001b[0;34m,\u001b[0m \u001b[0mweight\u001b[0m\u001b[0;34m,\u001b[0m \u001b[0mbias\u001b[0m\u001b[0;34m=\u001b[0m\u001b[0mbias\u001b[0m\u001b[0;34m)\u001b[0m\u001b[0;34m\u001b[0m\u001b[0;34m\u001b[0m\u001b[0m\n\u001b[0;32m-> 1608\u001b[0;31m     \u001b[0;32mif\u001b[0m \u001b[0minput\u001b[0m\u001b[0;34m.\u001b[0m\u001b[0mdim\u001b[0m\u001b[0;34m(\u001b[0m\u001b[0;34m)\u001b[0m \u001b[0;34m==\u001b[0m \u001b[0;36m2\u001b[0m \u001b[0;32mand\u001b[0m \u001b[0mbias\u001b[0m \u001b[0;32mis\u001b[0m \u001b[0;32mnot\u001b[0m \u001b[0;32mNone\u001b[0m\u001b[0;34m:\u001b[0m\u001b[0;34m\u001b[0m\u001b[0;34m\u001b[0m\u001b[0m\n\u001b[0m\u001b[1;32m   1609\u001b[0m         \u001b[0;31m# fused op is marginally faster\u001b[0m\u001b[0;34m\u001b[0m\u001b[0;34m\u001b[0m\u001b[0;34m\u001b[0m\u001b[0m\n\u001b[1;32m   1610\u001b[0m         \u001b[0mret\u001b[0m \u001b[0;34m=\u001b[0m \u001b[0mtorch\u001b[0m\u001b[0;34m.\u001b[0m\u001b[0maddmm\u001b[0m\u001b[0;34m(\u001b[0m\u001b[0mbias\u001b[0m\u001b[0;34m,\u001b[0m \u001b[0minput\u001b[0m\u001b[0;34m,\u001b[0m \u001b[0mweight\u001b[0m\u001b[0;34m.\u001b[0m\u001b[0mt\u001b[0m\u001b[0;34m(\u001b[0m\u001b[0;34m)\u001b[0m\u001b[0;34m)\u001b[0m\u001b[0;34m\u001b[0m\u001b[0;34m\u001b[0m\u001b[0m\n","\u001b[0;31mAttributeError\u001b[0m: 'DataLoader' object has no attribute 'dim'"]}]},{"cell_type":"code","metadata":{"id":"m_d7k5fy5vsv","colab_type":"code","colab":{},"executionInfo":{"status":"ok","timestamp":1593427356396,"user_tz":-540,"elapsed":1320,"user":{"displayName":"Juhee","photoUrl":"","userId":"14369088239483395487"}}},"source":["correct_prediction = correct_prediction.cpu().numpy().reshape(-1,1)"],"execution_count":24,"outputs":[]},{"cell_type":"code","metadata":{"id":"z9lUczhKqsUd","colab_type":"code","colab":{}},"source":["submit=pd.read_csv('submission.csv')\n","submit"],"execution_count":null,"outputs":[]},{"cell_type":"code","metadata":{"id":"D_Ycy_Fv5wIP","colab_type":"code","colab":{}},"source":["for i in range(len(correct_prediction)):\n","  submit['Label'][i]=correct_prediction[i].item()\n","\n","submit"],"execution_count":null,"outputs":[]},{"cell_type":"code","metadata":{"id":"hz3-6osgqwP-","colab_type":"code","colab":{}},"source":["submit.to_csv('submit.csv',index=False,header=True)\n","\n","kaggle competitions submit -c 2020-ai-exam-fashionmnist-1 -f submit.csv -m \"Message\""],"execution_count":null,"outputs":[]},{"cell_type":"code","metadata":{"id":"1Plcw-gYqwHf","colab_type":"code","colab":{}},"source":[""],"execution_count":null,"outputs":[]}]}